<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUANTFLOW | Math Proficiency Terminal</title>

    <!-- IBM Plex Mono Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="assets/css/styles.css">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"
        onerror="alert('Error: Tailwind CSS failed to load. Please check your connection.')"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1A1A1A">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/png" href="assets/img/icon-512.png">
    <link rel="apple-touch-icon" href="assets/img/icon-512.png">

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registered:', reg))
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'charcoal': '#1A1A1A',
                        'charcoal-light': '#222222',
                        'charcoal-lighter': '#2A2A2A',
                        'charcoal-border': '#333333',
                        'terminal-green': '#00D26A',
                        'terminal-green-dim': '#00A854',
                        'terminal-green-dark': '#004D25',
                        'signal-orange': '#FF9F1C',
                        'signal-orange-dark': '#CC7F16',
                        'signal-red': '#FF4B4B',
                        'signal-red-dark': '#CC3C3C',
                        'text-primary': '#E8E8E8',
                        'text-secondary': '#B0B0B0',
                        'text-muted': '#888888',
                        'text-muted': '#888888',
                        'text-dim': '#666666',
                        'session-gold': '#FFD700',
                    },
                    fontSize: {
                        'xs': '0.8125rem',
                        'sm': '0.9375rem',
                        'base': '1.0625rem',
                        'lg': '1.1875rem',
                        'xl': '1.3125rem',
                    },
                    fontFamily: {
                        'mono': ['IBM Plex Mono', 'monospace'],
                    },
                    borderRadius: {
                        'none': '0',
                    },
                    animation: {
                        'flash-green': 'flashGreen 0.3s ease-out',
                        'flash-orange': 'flashOrange 0.3s ease-out',
                        'flash-red': 'flashRed 0.3s ease-out',
                        'pulse-slow': 'pulse 3s infinite',
                        'blink': 'blink 1s step-end infinite',
                    }
                }
            }
        }
    </script>

    <!-- Fraction.js -->
    <script src="https://cdn.jsdelivr.net/npm/fraction.js@5.3.4/dist/fraction.min.js"
        onerror="this.onerror=null;this.src='https://unpkg.com/fraction.js@5.3.4/dist/fraction.min.js'"></script>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.3/dist/cdn.min.js"
        onerror="this.onerror=null;this.src='https://unpkg.com/alpinejs@3.15.3/dist/cdn.min.js'"></script>
    <script src="assets/js/engine.js"></script>
    <script src="assets/js/audio.js"></script>
    <script src="assets/js/particles.js"></script>
    <script src="assets/js/store-auth.js"></script>
    <script src="assets/js/store-settings.js"></script>
    <script src="assets/js/app.js"></script>
</head>

<body class="bg-charcoal text-text-primary font-mono h-screen flex flex-col overflow-hidden" x-data="quantflow"
    x-init="init()" @click="focusInput()" @keydown.window="handleKeydown($event)">

    <!-- crt overlay -->
    <div class="crt-overlay scanlines"></div>
    <div class="crt-overlay vignette"></div>

    <!-- Toast Container -->
    <div class="fixed top-20 right-4 z-50 flex flex-col gap-2 pointer-events-none">
        <template x-for="toast in toasts" :key="toast.id">
            <div x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 translate-x-8" x-transition:enter-end="opacity-100 translate-x-0"
                x-transition:leave="transition ease-in duration-300"
                x-transition:leave-start="opacity-100 translate-x-0" x-transition:leave-end="opacity-0 translate-x-8"
                class="bg-charcoal border border-terminal-green/50 shadow-lg p-3 flex items-center gap-3 w-64 pointer-events-auto backdrop-blur-md">
                <div class="text-xl" x-text="toast.icon"></div>
                <div class="text-sm font-bold text-terminal-green tracking-wide" x-text="toast.title"></div>
            </div>
        </template>
    </div>

    <!-- Icon Sprite (Simplified) -->
    <svg style="display: none;">
        <symbol id="icon-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="square">
            <path d="M4 6h16M4 12h16M4 18h16" />
        </symbol>
        <symbol id="icon-analytics" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="square">
            <path
                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
        </symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
            </path>
        </symbol>
        <symbol id="icon-backspace" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path
                d="M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 001.414.586H19a2 2 0 002-2V7a2 2 0 00-2-2h-8.172a2 2 0 00-1.414.586L3 12z" />
        </symbol>
    </svg>

    <!-- ═══════════════════════════════════════════════════════════════════════════════
         TOP STATUS BAR - Session Metrics & System Status
         ═══════════════════════════════════════════════════════════════════════════════ -->
    <header
        class="h-10 bg-charcoal-light border-b border-charcoal-border flex items-center justify-between px-4 text-xs">
        <!-- Left: Branding -->
        <div class="flex items-center gap-4">
            <!-- Mobile Menu Toggle -->
            <button @click="sidebarOpen = !sidebarOpen; analyticsOpen = false"
                class="md:hidden p-1 text-text-muted hover:text-terminal-green transition-colors">
                <svg class="w-5 h-5">
                    <use href="#icon-menu" />
                </svg>
            </button>

            <div class="flex items-center gap-2">
                <span class="text-terminal-green font-bold text-sm tracking-wider">QUANTFLOW</span>
                <span class="text-text-muted hidden sm:inline">v2.4.1</span>
            </div>
            <div class="h-4 w-px bg-charcoal-border hidden sm:block"></div>
            <div class="flex items-center gap-2">
                <span class="status-indicator" :class="session.isActive ? 'online' : ''"></span>
                <span class="text-text-secondary hidden sm:inline"
                    x-text="session.isActive ? 'SESSION ACTIVE' : 'READY'"></span>
            </div>
        </div>

        <!-- Center: Live Metrics -->
        <div class="hidden lg:flex items-center gap-6">
            <template x-for="metric in headerMetrics" :key="metric.label">
                <div class="flex items-center gap-2">
                    <span class="text-text-muted" x-text="metric.label"></span>
                    <span :class="metric.colorClass" class="font-medium" x-text="metric.value"></span>
                    <div class="h-4 w-px bg-charcoal-border" x-show="!$el.nextElementSibling?.matches(':last-child')">
                    </div>
                </div>
            </template>
        </div>

        <!-- Right: Time & Auth & Controls -->
        <div class="flex items-center gap-4">
            <!-- Auth Status -->
            <div class="flex items-center gap-3">
                <template x-if="!auth.isLoggedIn">
                    <button @click="loginWithGitHub"
                        class="text-text-muted hover:text-terminal-green flex items-center gap-1.5 transition-colors group">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.041-1.416-4.041-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                        </svg>
                        <span class="group-hover:underline">LOGIN</span>
                    </button>
                </template>
                <template x-if="auth.isLoggedIn">
                    <div class="flex items-center gap-3">
                        <span class="text-terminal-green flex items-center gap-1.5">
                            <span class="w-1.5 h-1.5 bg-terminal-green rounded-full animate-pulse"></span>
                            <span x-text="auth.user?.userId.toUpperCase() || 'LOADING...'"></span>
                        </span>
                        <div class="h-4 w-px bg-charcoal-border"></div>
                        <button @click="logout"
                            class="text-text-muted hover:text-signal-red transition-colors">LOGOUT</button>
                    </div>
                </template>
            </div>

            <div class="h-4 w-px bg-charcoal-border hidden sm:block"></div>
            <div class="hidden sm:flex items-center gap-2">
                <span class="text-text-muted">SESSION</span>
                <span class="text-text-secondary font-medium" x-text="formatSessionTime(session.seconds)"></span>
            </div>
            <!-- Analytics Toggle (Mobile) -->
            <button @click="analyticsOpen = !analyticsOpen; sidebarOpen = false"
                class="lg:hidden p-1 text-text-muted hover:text-terminal-green transition-colors">
                <svg class="w-5 h-5">
                    <use href="#icon-analytics" />
                </svg>
            </button>

            <button @click="settingsOpen = true"
                class="p-1 text-text-muted hover:text-terminal-green transition-colors">
                <svg class="w-5 h-5">
                    <use href="#icon-settings" />
                </svg>
            </button>
        </div>
    </header>

    <!-- ═══════════════════════════════════════════════════════════════════════════════
         MAIN CONTENT AREA - Three Column Layout
         ═══════════════════════════════════════════════════════════════════════════════ -->
    <main class="flex-1 flex overflow-hidden relative">

        <!-- ═══════════════════════════════════════════════════════════════════════════
             LEFT PANEL - Category Selection & Configuration
             ═══════════════════════════════════════════════════════════════════════════ -->
        <!-- Mobile Sidebars Overlay -->
        <div x-show="sidebarOpen || analyticsOpen" @click="sidebarOpen = false; analyticsOpen = false"
            class="modal-backdrop md:hidden !bg-black/60" x-cloak x-transition.opacity>
        </div>

        <aside :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'"
            class="sidebar-base left-0 border-r border-charcoal-border -translate-x-full" x-cloak>
            <!-- Panel Header -->
            <div class="panel-header">
                <span class="text-xs text-text-muted font-medium tracking-wide">OPERATION SELECT</span>
                <button @click="sidebarOpen = false" class="close-btn md:hidden">&times;</button>
            </div>

            <div class="flex-1 overflow-y-auto custom-scrollbar flex flex-col">

                <!-- Categories Grid -->
                <div class="panel-section">
                    <div class="grid grid-cols-2 gap-1">
                        <template x-for="(op, key) in operations" :key="key">
                            <button
                                class="category-btn px-3 py-3 text-xs font-medium border border-charcoal-border bg-charcoal-light hover:bg-charcoal-lighter transition-colors text-left"
                                :class="{ 'active': practice.category === key }" @click="selectCategory(key)">
                                <span class="block text-xs opacity-60" x-text="getCategoryIndex(key)"></span>
                                <span x-text="key.toUpperCase()"></span>
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Tier Selection -->
                <div class="panel-section">
                    <div class="panel-section-title">
                        <span>COMPLEXITY TIER</span>
                        <span class="text-terminal-green" x-text="currentTierLabel"></span>
                    </div>
                    <div class="flex flex-wrap gap-1">
                        <template x-for="(tier, idx) in currentOperation.tiers" :key="tier.id">
                            <button class="btn-ghost tier-btn" :class="{ 'active': practice.tier === tier.id }"
                                @click="selectTier(tier.id)" x-text="tier.label">
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Round Size Selection -->
                <div class="panel-section">
                    <div class="panel-section-title">
                        <span>QUESTIONS</span>
                        <span class="text-terminal-green" x-text="round.targetCount"></span>
                    </div>
                    <div class="flex flex-wrap gap-1">
                        <template x-for="count in [10, 20, 30, 50, 100]" :key="count">
                            <button class="btn-ghost tier-btn" :class="{ 'active': round.targetCount === count }"
                                @click="selectRoundSize(count)" x-text="count">
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Variants -->
                <div class="panel-section flex-1">
                    <div class="panel-section-title">
                        <span>VARIANTS</span>
                    </div>
                    <div class="space-y-1">
                        <template x-for="variant in currentOperation.variants" :key="variant.id">
                            <label
                                class="flex items-center gap-2 p-3 bg-charcoal border border-charcoal-border cursor-pointer hover:border-terminal-green transition-colors">
                                <input type="checkbox" class="variant-checkbox w-4 h-4 accent-terminal-green"
                                    :value="variant.id" :checked="practice.variants.includes(variant.id)"
                                    @change="toggleVariant(variant.id)">
                                <span class="text-xs" x-text="variant.label"></span>
                            </label>
                        </template>
                    </div>
                </div>


            </div>
        </aside>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             CENTER PANEL - Main Practice Area
             ═══════════════════════════════════════════════════════════════════════════ -->
        <section class="flex-1 flex flex-col">
            <!-- Practice Header -->
            <div class="h-8 bg-charcoal-lighter border-b border-charcoal-border flex items-center justify-between px-4">
                <div class="flex items-center gap-3">
                    <span class="text-xs text-terminal-green px-2 py-0.5 border border-terminal-green"
                        x-text="practice.category.toUpperCase()"></span>
                </div>
                <div class="flex items-center gap-4 text-xs">
                    <div class="flex items-center gap-2">
                        <span class="text-text-muted">ROUND</span>
                        <span class="text-terminal-green font-medium" x-text="roundProgress"></span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-text-muted">PAR</span>
                        <span class="text-signal-orange font-medium" x-text="parTimeDisplay"></span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-text-muted">QUEUE</span>
                        <span class="text-text-primary font-medium" x-text="questionQueue.length"></span>
                    </div>
                </div>
            </div>

            <!-- Main Content Area - Scroll Snap Container -->
            <div class="flex-1 overflow-y-auto custom-scrollbar bg-charcoal snap-y snap-mandatory"
                style="scroll-snap-type: y mandatory;">

                <!-- ═══════════════════════════════════════════════════════════════════
                     PAGE 1: Question Board + Bottom Bar + Keyboard (Full Height Snap)
                     ═══════════════════════════════════════════════════════════════════ -->
                <div class="min-h-full flex flex-col snap-start snap-always" style="scroll-snap-align: start;">

                    <!-- Main Question Area -->
                    <div class="flex-1 flex flex-col items-center justify-center relative border border-charcoal-border m-2 sm:m-4 bg-charcoal-light"
                        :class="flashClass" x-ref="questionContainer">

                        <!-- Pause Overlay -->
                        <div x-show="session.isPaused" x-cloak x-transition.opacity
                            class="absolute inset-0 bg-charcoal/90 flex flex-col items-center justify-center z-20">
                            <div class="text-terminal-green text-4xl font-bold tracking-widest mb-4">PAUSED</div>
                            <div class="text-text-muted text-xs animate-pulse">PRESS ESC TO RESUME</div>
                        </div>

                        <!-- Question Display -->
                        <div class="text-center">
                            <div class="text-4xl md:text-6xl font-bold tracking-tight mb-8"
                                x-html="questionDisplayHtml">
                            </div>

                            <!-- Input Area -->
                            <div class="relative flex flex-col items-center">
                                <input type="text" x-model="userAnswer" x-ref="answerInput"
                                    @keydown.enter.prevent="submitAnswer" @input="handleInput"
                                    :disabled="!session.isActive || session.isPaused" inputmode="none"
                                    class="w-full max-w-[280px] h-16 bg-charcoal border-2 border-charcoal-border text-4xl text-center font-bold text-text-primary input-field !focus:border-terminal-green transition-colors"
                                    placeholder="?" autocomplete="off">
                            </div>

                            <!-- Timer Display -->
                            <div class="mt-6 flex items-center justify-center gap-4">
                                <div class="text-2xl font-bold tabular-nums" :class="timerColorClass"
                                    x-show="$store.settings.display.showTimer">
                                    <span x-text="liveTimerDisplay"></span><span class="text-sm"
                                        x-show="session.isActive">s</span>
                                </div>
                            </div>
                        </div>

                        <!-- Subtle Feedback Overlay (Success/Warning) -->
                        <div class="absolute bottom-4 right-4 flex items-end justify-end transition-all duration-150 z-30"
                            x-show="feedback.visible && feedback.type !== 'error'" x-cloak
                            :class="feedback.visible ? 'opacity-100 translate-y-0' : 'opacity-0 pointer-events-none translate-y-2'">
                            <div class="bg-charcoal p-3 flex items-center gap-3 shadow-2xl"
                                :class="feedbackBorderClass">
                                <div class="text-2xl" :class="feedbackColorClass" x-text="feedback.icon"></div>
                                <div class="text-left">
                                    <div class="text-xs font-bold leading-none" :class="feedbackColorClass"
                                        x-text="feedback.text"></div>
                                    <div class="text-[10px] text-text-muted mt-0.5 tabular-nums"
                                        x-text="feedback.detail">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Prominent Error Overlay (Centered) -->
                        <div class="absolute inset-0 flex items-center justify-center z-40 bg-black/40 backdrop-blur-[2px]"
                            x-show="feedback.visible && feedback.type === 'error'" x-cloak
                            x-transition:enter="transition ease-out duration-200"
                            x-transition:enter-start="opacity-0 scale-95"
                            x-transition:enter-end="opacity-100 scale-100">
                            <div
                                class="bg-charcoal border-2 border-signal-red p-6 shadow-[0_0_40px_rgba(255,75,75,0.3)] text-center animate-shake w-full max-w-[320px] mx-4">
                                <div class="text-5xl mb-3 text-signal-red" x-text="feedback.icon"></div>
                                <div class="text-3xl font-bold tracking-tight text-signal-red mb-2"
                                    x-text="feedback.text">
                                </div>
                                <div class="text-lg font-medium text-text-primary px-4 py-2 bg-signal-red/10 border border-signal-red/20 tabular-nums"
                                    x-text="feedback.detail"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Virtual Keyboard (Mobile/Tablet Only) -->
                    <div class="lg:hidden p-2 bg-charcoal border-t border-charcoal-border select-none flex-shrink-0"
                        x-show="session.isActive && !session.isPaused">
                        <!-- Top Row: Special Symbols (Half Height) -->
                        <div class="grid grid-cols-2 gap-1 mb-1">
                            <button @click="inputKey('/')"
                                class="h-7 bg-charcoal-light border border-charcoal-border text-lg font-bold hover:bg-charcoal-lighter active:bg-terminal-green active:text-charcoal transition-colors flex items-center justify-center">
                                /
                            </button>
                            <button @click="inputKey('-')"
                                class="h-7 bg-charcoal-light border border-charcoal-border text-lg font-bold hover:bg-charcoal-lighter active:bg-terminal-green active:text-charcoal transition-colors flex items-center justify-center">
                                -
                            </button>
                        </div>
                        <!-- Main Keyboard Grid -->
                        <div class="grid grid-cols-3 gap-1">
                            <template x-for="key in virtualKeys" :key="key">
                                <button @click="inputKey(key)"
                                    class="h-14 bg-charcoal-light border border-charcoal-border text-xl font-bold hover:bg-charcoal-lighter active:bg-terminal-green active:text-charcoal transition-colors">
                                    <span x-text="key"></span>
                                </button>
                            </template>
                            <button @click="inputKey('backspace')"
                                class="h-14 bg-charcoal-light border border-charcoal-border text-xl font-bold hover:bg-charcoal-lighter active:bg-signal-red active:text-white transition-colors group">
                                <svg class="w-6 h-6 mx-auto">
                                    <use href="#icon-backspace" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Bottom Bar: Recent Responses + Session Controls (At Bottom) -->
                    <div
                        class="min-h-14 border-t border-charcoal-border flex flex-col sm:flex-row items-center justify-between px-4 py-2 sm:py-0 gap-3 bg-charcoal-light flex-shrink-0 mt-auto">
                        <!-- Recent Responses -->
                        <div class="flex items-center gap-2 overflow-x-auto flex-1">
                            <span class="text-xs text-text-muted flex-shrink-0">RECENT:</span>
                            <div class="flex gap-1">
                                <template x-for="(response, idx) in recentResponses.slice(0, 10)" :key="idx">
                                    <div class="response-chip" :class="getResponseClass(response)"
                                        :title="formatTime(response.time)" x-text="response.correct ? '✓' : '✗'">
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Session Controls (Integrated) -->
                        <div class="flex gap-2 flex-shrink-0">
                            <button @click="session.isActive ? togglePause() : startSession()"
                                class="px-4 py-1.5 font-bold text-xs transition-colors"
                                :class="!session.isActive || session.isPaused ? 'bg-terminal-green text-charcoal hover:bg-terminal-green-dim' : 'bg-charcoal border border-signal-orange text-signal-orange hover:bg-signal-orange/10'"
                                x-text="!session.isActive ? 'START' : (session.isPaused ? 'RESUME' : 'PAUSE')">
                            </button>
                            <button @click="resetSession"
                                class="btn-ghost !text-text-muted hover:!border-signal-red hover:!text-signal-red">
                                RESET
                            </button>
                        </div>
                    </div>
                </div>

                <!--PAGE 2: Feedback Console (Full Height Snap) -->
                <div class="min-h-full flex flex-col snap-start snap-always p-2 sm:p-4 bg-charcoal"
                    style="scroll-snap-align: start;">
                    <div class="border border-charcoal-border bg-charcoal-light flex flex-col shadow-inner flex-1">
                        <div class="panel-header">
                            <span class="text-xs text-text-muted font-medium tracking-wide">FEEDBACK CONSOLE</span>
                        </div>
                        <div class="flex-1 overflow-y-auto p-4 text-xs font-mono space-y-2 bg-black/20" x-ref="console">
                            <template x-for="(entry, idx) in consoleLogs" :key="idx">
                                <div class="leading-relaxed border-l-2 pl-3"
                                    :class="[entry.colorClass, entry.colorClass.replace('text-', 'border-')]"
                                    x-text="entry.text"></div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ═══════════════════════════════════════════════════════════════════════════
             RIGHT PANEL - Analytics & Performance
             ═══════════════════════════════════════════════════════════════════════════ -->
        <aside :class="analyticsOpen ? 'translate-x-0' : 'translate-x-full'"
            class="sidebar-base right-0 border-l border-charcoal-border lg:relative lg:translate-x-0 translate-x-full"
            x-cloak>
            <!-- Focus Mode Toggle & Header -->
            <div class="panel-header justify-between">
                <span class="text-xs text-text-muted font-medium tracking-wide">PERFORMANCE ANALYTICS</span>
                <div class="flex items-center gap-2">
                    <button @click="analyticsMode = analyticsMode === 'expanded' ? 'collapsed' : 'expanded'"
                        class="p-1 hover:text-terminal-green transition-colors"
                        :title="analyticsMode === 'expanded' ? 'Collapse to Focus Mode' : 'Expand Analytics'">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4">
                            </path>
                        </svg>
                    </button>
                    <button @click="analyticsOpen = false" class="close-btn lg:hidden">&times;</button>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto custom-scrollbar">

                <!-- ════════════════════════════════════════════════════════════
                         SESSION PERFORMANCE CARD (NEW)
                         ════════════════════════════════════════════════════════════ -->
                <div class="panel-section !pb-4" x-show="analyticsMode === 'expanded'">
                    <div class="bg-charcoal-light border border-charcoal-border p-3 relative overflow-hidden group">
                        <!-- Background Pulse Animation for Active Session -->
                        <div class="absolute inset-0 bg-terminal-green/5 opacity-0 transition-opacity duration-1000"
                            :class="session.isActive && !session.isPaused ? 'opacity-100 animate-pulse-slow' : ''">
                        </div>

                        <div class="relative z-10">
                            <div class="flex justify-between items-center mb-3">
                                <div class="flex items-center gap-2">
                                    <div class="w-2 h-2 rounded-full"
                                        :class="isSessionRunning ? 'bg-terminal-green animate-pulse' : 'bg-text-muted'">
                                    </div>
                                    <span class="text-xs font-bold tracking-wider text-text-secondary">CURRENT
                                        SESSION</span>
                                </div>
                                <div class="text-[10px] text-text-muted" x-show="sessionDeltas">
                                    <span :class="sessionDeltas?.accClass" x-text="sessionDeltas?.acc"></span> vs start
                                </div>
                            </div>

                            <!-- Progress Bar -->
                            <div class="w-full h-1.5 bg-charcoal-border mb-4 rounded-full overflow-hidden">
                                <div class="h-full bg-terminal-green transition-all duration-500 ease-out"
                                    :style="`width: ${(round.currentCount / round.targetCount) * 100}%`"></div>
                            </div>

                            <div class="flex justify-between items-end">
                                <div class="text-center">
                                    <div class="text-xs text-text-muted mb-0.5">ACCURACY</div>
                                    <div class="text-xl font-bold stat-value" :class="getAccuracyClass(roundAccuracy)"
                                        x-text="roundAccuracy + '%'"
                                        x-effect="if (roundAccuracy > 0) $el.classList.add('pulse'); setTimeout(() => $el.classList.remove('pulse'), 300)">
                                    </div>
                                </div>
                                <div class="h-8 w-px bg-charcoal-border/50"></div>
                                <div class="text-center">
                                    <div class="text-xs text-text-muted mb-0.5">AVG TIME</div>
                                    <div class="text-xl font-bold text-text-primary stat-value" x-text="roundAvgTime">
                                    </div>
                                </div>
                                <div class="h-8 w-px bg-charcoal-border/50"></div>
                                <div class="text-center">
                                    <div class="text-xs text-text-muted mb-0.5">STREAK</div>
                                    <div class="text-xl font-bold text-terminal-green stat-value"
                                        x-text="getCurrentStats().streak"
                                        x-effect="if (getCurrentStats().streak > 0) $el.classList.add('pulse'); setTimeout(() => $el.classList.remove('pulse'), 300)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ════════════════════════════════════════════════════════════
                         LATENCY SPARKLINE (ENHANCED)
                         ════════════════════════════════════════════════════════════ -->
                <div class="panel-section" x-show="analyticsMode === 'expanded'">
                    <div class="panel-section-title">
                        <span>LATENCY TREND</span>
                        <span class="text-text-muted text-[10px]">(LAST 20)</span>
                    </div>
                    <div class="h-20 bg-charcoal border border-charcoal-border relative overflow-hidden group cursor-crosshair"
                        @mousemove="
                            const rect = $el.getBoundingClientRect();
                            const physicalX = $event.clientX - rect.left;
                            const logicalX = (physicalX / rect.width) * 280;
                            const stats = getCurrentStats();
                            const data = stats.latencies.slice(-20);
                            if (data.length > 1) {
                                const index = Math.min(data.length - 1, Math.max(0, Math.round((logicalX / 280) * (data.length - 1))));
                                sparklineHover.index = index;
                                sparklineHover.x = (index / (data.length - 1)) * 280;
                                sparklineHover.value = data[index];
                                sparklineHover.visible = true;
                            }
                        " @mouseleave="sparklineHover.visible = false">
                        <template x-if="sparklineComponents.hasData">
                            <svg class="w-full h-full" preserveAspectRatio="none" viewBox="0 0 280 80">
                                <defs>
                                    <linearGradient id="sparkGradient" x1="0" x2="0" y1="0" y2="1">
                                        <stop offset="0%" stop-color="#00D26A" stop-opacity="0.2" />
                                        <stop offset="100%" stop-color="#00D26A" stop-opacity="0" />
                                    </linearGradient>
                                </defs>
                                <!-- Area Fill -->
                                <path :d="sparklineComponents.fill" fill="url(#sparkGradient)" />
                                <!-- Main Line -->
                                <path :d="sparklineComponents.path" fill="none" stroke="#00D26A" stroke-width="1.5"
                                    vector-effect="non-scaling-stroke" />
                                <!-- Moving Average -->
                                <path :d="sparklineComponents.maPath" fill="none" stroke="#FF9F1C" stroke-width="1"
                                    stroke-dasharray="2,2" opacity="0.6" vector-effect="non-scaling-stroke" />

                                <!-- Hover Indicator Line -->
                                <line x-show="sparklineHover.visible" :x1="sparklineHover.x" :x2="sparklineHover.x"
                                    y1="0" y2="100%" stroke="white" stroke-width="1" stroke-dasharray="2,2"
                                    opacity="0.4" vector-effect="non-scaling-stroke" />
                            </svg>
                        </template>

                        <!-- Tooltip Overlay (Dynamic) -->
                        <div x-show="sparklineHover.visible"
                            class="absolute top-1 bg-charcoal/90 px-2 py-1 rounded border border-terminal-green/50 pointer-events-none transition-all duration-75 z-20 whitespace-nowrap"
                            :style="`left: ${Math.min((sparklineHover.x / 280) * 100, 80)}%; transform: translateX(${(sparklineHover.x / 280) > 0.8 ? '-100%' : '0'});`"
                            x-cloak>
                            <div class="text-[10px] text-text-muted leading-none mb-1 text-center">LATENCY</div>
                            <div class="text-xs font-bold text-terminal-green font-mono"
                                x-text="formatTime(sparklineHover.value)"></div>
                        </div>

                        <!-- Static 'Last' tooltip when not hovering -->
                        <div x-show="!sparklineHover.visible"
                            class="absolute top-1 right-1 text-[10px] text-terminal-green font-mono bg-charcoal/80 px-1 rounded border border-charcoal-border opacity-0 group-hover:opacity-100 transition-opacity">
                            Last: <span x-text="formatTime(latencies[latencies.length-1] || 0)"></span>
                        </div>
                    </div>
                </div>

                <!-- ════════════════════════════════════════════════════════════
                         PERFORMANCE RING (REPLACES BREAKDOWN)
                         ════════════════════════════════════════════════════════════ -->
                <div class="panel-section" x-show="analyticsMode === 'expanded'">
                    <div class="panel-section-title">PERFORMANCE DISTRIBUTION</div>
                    <div class="flex items-center gap-4 py-2">
                        <!-- Triple Ring Gauge -->
                        <div class="relative w-24 h-24 flex-shrink-0">
                            <!-- Tracks -->
                            <div class="absolute inset-0 rounded-full border-4 border-charcoal-lighter"
                                style="transform: scale(1)"></div>
                            <div class="absolute inset-0 rounded-full border-4 border-charcoal-lighter"
                                style="transform: scale(0.75)"></div>
                            <div class="absolute inset-0 rounded-full border-4 border-charcoal-lighter"
                                style="transform: scale(0.5)"></div>

                            <!-- Arcs -->
                            <div class="absolute inset-0 rounded-full"
                                :style="`background: ${performanceRing.fast}; -webkit-mask: radial-gradient(transparent 64%, black 65%); transform: scale(1); rotate(-90deg)`">
                            </div>
                            <div class="absolute inset-0 rounded-full"
                                :style="`background: ${performanceRing.slow}; -webkit-mask: radial-gradient(transparent 64%, black 65%); transform: scale(0.75); rotate(-90deg)`">
                            </div>
                            <div class="absolute inset-0 rounded-full"
                                :style="`background: ${performanceRing.error}; -webkit-mask: radial-gradient(transparent 64%, black 65%); transform: scale(0.5); rotate(-90deg)`">
                            </div>

                            <!-- Center Text -->
                            <div class="absolute inset-0 flex flex-col items-center justify-center">
                                <span class="text-xs font-bold text-text-primary" x-text="performanceRing.total"></span>
                                <span class="text-[8px] text-text-muted">TOTAL</span>
                            </div>
                        </div>

                        <!-- Legend -->
                        <div class="flex-1 space-y-2 text-xs">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-2">
                                    <div class="w-2 h-2 bg-terminal-green rounded-sm"></div>
                                    <span class="text-text-secondary">FAST</span>
                                </div>
                                <span class="font-bold text-terminal-green"
                                    x-text="performanceRing.fastPct + '%'"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-2">
                                    <div class="w-2 h-2 bg-signal-orange rounded-sm"></div>
                                    <span class="text-text-secondary">SLOW</span>
                                </div>
                                <span class="font-bold text-signal-orange"
                                    x-text="performanceRing.slowPct + '%'"></span>
                            </div>
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-2">
                                    <div class="w-2 h-2 bg-signal-red rounded-sm"></div>
                                    <span class="text-text-secondary">ERROR</span>
                                </div>
                                <span class="font-bold text-signal-red" x-text="performanceRing.errorPct + '%'"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ════════════════════════════════════════════════════════════
                         HEATMAP (KEPT MOSTLY SAME)
                         ════════════════════════════════════════════════════════════ -->
                <div class="panel-section cursor-pointer hover:bg-charcoal-light/10 transition-colors"
                    @click="heatmapExpanded = !heatmapExpanded" x-show="analyticsMode === 'expanded'">
                    <div class="panel-section-title">
                        <span class="transition-all duration-300"
                            x-text="heatmapExpanded ? '28-DAY ACTIVITY' : '7-DAY ACTIVITY'"></span>
                        <span class="text-text-secondary" x-text="heatmapTotal + ' problems'"></span>
                    </div>
                    <div class="grid grid-cols-7 gap-1">
                        <template x-for="cell in heatmapCells" :key="cell.date">
                            <div class="heatmap-cell w-full aspect-square border border-charcoal-border relative group"
                                :class="cell.colorClass">
                                <!-- Highlight Today -->
                                <div x-show="cell.date === new Date().toISOString().split('T')[0]"
                                    class="absolute inset-0 border border-white/50"></div>
                                <!-- Tooltip -->
                                <div
                                    class="absolute bottom-full left-1/2 -translate-x-1/2 mb-1 px-2 py-1 bg-black text-white text-[10px] whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50 border border-charcoal-border shadow-xl">
                                    <span x-text="cell.date"></span>: <span class="text-terminal-green font-bold"
                                        x-text="cell.count"></span>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- ════════════════════════════════════════════════════════════
                         STATS GRID HIERARCHY (REDESIGNED)
                         ════════════════════════════════════════════════════════════ -->
                <div class="panel-section !pb-0" x-show="analyticsMode === 'expanded'">
                    <div class="panel-section-title">ALL TIME STATS</div>
                    <div class="bg-charcoal-light border border-charcoal-border p-3 text-center mb-1">
                        <div class="text-xs text-text-muted mb-1">ACCURACY</div>
                        <div class="text-3xl font-bold"
                            :class="getAccuracyClass(parseFloat(categoryStatsDisplay[0].value))"
                            x-text="categoryStatsDisplay[0].value"></div>
                        <!-- Trend Badge -->
                        <div x-show="categoryStatsDisplay[0].trend" x-cloak
                            class="text-xs font-medium mt-1 inline-flex items-center gap-0.5"
                            :class="categoryStatsDisplay[0].trend?.colorClass"
                            x-text="categoryStatsDisplay[0].trend?.formatted"></div>
                    </div>
                    <div class="grid grid-cols-3 gap-1">
                        <div class="bg-charcoal-light border border-charcoal-border p-2 text-center">
                            <div class="text-[10px] text-text-muted mb-0.5">BEST</div>
                            <div class="text-lg font-bold text-session-gold" x-text="categoryStatsDisplay[1].value">
                            </div>
                            <div x-show="categoryStatsDisplay[1].trend" x-cloak
                                class="text-[10px] font-bold mt-0.5 animate-pulse"
                                :class="categoryStatsDisplay[1].trend?.colorClass"
                                x-text="categoryStatsDisplay[1].trend?.formatted"></div>
                        </div>
                        <div class="bg-charcoal-light border border-charcoal-border p-2 text-center">
                            <div class="text-[10px] text-text-muted mb-0.5">AVG</div>
                            <div class="text-lg font-bold text-text-primary" x-text="categoryStatsDisplay[2].value">
                            </div>
                            <div x-show="categoryStatsDisplay[2].trend" x-cloak class="text-[10px] font-medium mt-0.5"
                                :class="categoryStatsDisplay[2].trend?.colorClass"
                                x-text="categoryStatsDisplay[2].trend?.formatted"></div>
                        </div>
                        <div class="bg-charcoal-light border border-charcoal-border p-2 text-center">
                            <div class="text-[10px] text-text-muted mb-0.5">TOTAL</div>
                            <div class="text-lg font-bold text-text-secondary" x-text="categoryStatsDisplay[3].value">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ════════════════════════════════════════════════════════════
                         FOCUS MODE VIEW
                         ════════════════════════════════════════════════════════════ -->
                <div class="p-4 space-y-4" x-show="analyticsMode === 'collapsed'">
                    <div class="text-center">
                        <div class="text-xs text-text-muted">STREAK</div>
                        <div class="text-4xl font-bold text-terminal-green animate-pulse-slow"
                            x-text="getCurrentStats().streak"></div>
                    </div>
                    <div class="h-px bg-charcoal-border w-1/2 mx-auto"></div>
                    <div class="text-center">
                        <div class="text-xs text-text-muted">SESSION TIME</div>
                        <div class="text-xl font-mono text-text-primary" x-text="formatSessionTime(session.seconds)">
                        </div>
                    </div>
                </div>

            </div>
        </aside>
    </main>



    <!-- ═══════════════════════════════════════════════════════════════════════════════
         BOTTOM STATUS BAR
         ═══════════════════════════════════════════════════════════════════════════════ -->


    <!-- ═══════════════════════════════════════════════════════════════════════════════
         SETTINGS MODAL
         ═══════════════════════════════════════════════════════════════════════════════ -->
    <div x-show="settingsOpen" x-cloak x-transition.opacity @keydown.escape.window="settingsOpen = false"
        class="modal-backdrop">
        <div class="bg-charcoal border border-charcoal-border w-full max-w-[500px] mx-4 max-h-[90vh] overflow-hidden flex flex-col"
            @click.outside="settingsOpen = false">
            <div class="panel-header !h-10">
                <span class="text-sm font-medium">SETTINGS</span>
                <button @click="settingsOpen = false" class="close-btn">&times;</button>
            </div>
            <div class="p-4 space-y-4 overflow-y-auto flex-1">
                <!-- Timing Settings Removed -->

                <!-- Display Settings -->
                <div>
                    <div class="text-xs text-text-muted mb-2">DISPLAY</div>
                    <div class="space-y-2">
                        <template x-for="setting in displaySettings" :key="setting.key">
                            <label
                                class="flex items-center justify-between bg-charcoal-light p-2 border border-charcoal-border">
                                <span class="text-xs" x-text="setting.label"></span>
                                <input type="checkbox" x-model="$store.settings.display[setting.key]"
                                    @change="$store.settings.save()" class="w-4 h-4 accent-terminal-green">
                            </label>
                        </template>
                    </div>
                </div>

                <!-- Data Management -->
                <div>
                    <div class="panel-section-title">DATA MANAGEMENT</div>
                    <div class="flex gap-2">
                        <button @click="openExportModal"
                            class="btn-ghost flex-1 hover:!border-terminal-green hover:!text-terminal-green">
                            EXPORT DATA
                        </button>
                        <button @click="openImportModal"
                            class="btn-ghost flex-1 hover:!border-signal-orange hover:!text-signal-orange">
                            IMPORT DATA
                        </button>
                        <button @click="openConfirmClear"
                            class="btn-ghost flex-1 !border-signal-red !text-signal-red hover:!bg-signal-red hover:!text-charcoal">
                            CLEAR ALL
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div x-show="exportModalOpen" x-cloak x-transition.opacity class="modal-backdrop">
        <div class="bg-charcoal border border-terminal-green w-full max-w-[400px] mx-4 flex flex-col"
            @click.outside="exportModalOpen = false">
            <div class="panel-header !h-10 text-terminal-green">
                <span class="text-sm font-medium">EXPORT DATA</span>
                <button @click="exportModalOpen = false" class="close-btn">&times;</button>
            </div>
            <div class="p-4">
                <textarea readonly x-model="exportDataStr" @click="$el.select()"
                    class="w-full h-32 bg-charcoal-light border border-charcoal-border text-xs font-mono p-2 focus:border-terminal-green outline-none resize-none"></textarea>
                <div class="text-[10px] text-text-muted mt-2 text-center">CLICK TO SELECT ALL • CTRL+C TO COPY</div>
                <button @click="exportModalOpen = false"
                    class="w-full mt-3 py-2 bg-charcoal-light border border-charcoal-border hover:bg-charcoal-lighter transition-colors text-xs font-bold">CLOSE</button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div x-show="importModalOpen" x-cloak x-transition.opacity class="modal-backdrop">
        <div class="bg-charcoal border border-signal-orange w-full max-w-[400px] mx-4 flex flex-col"
            @click.outside="importModalOpen = false">
            <div class="panel-header !h-10 text-signal-orange">
                <span class="text-sm font-medium">IMPORT DATA</span>
                <button @click="importModalOpen = false" class="close-btn">&times;</button>
            </div>
            <div class="p-4">
                <textarea x-model="importDataStr" placeholder="Paste JSON here..."
                    class="w-full h-32 bg-charcoal-light border border-charcoal-border text-xs font-mono p-2 focus:border-signal-orange outline-none resize-none"></textarea>
                <div class="flex gap-2 mt-3">
                    <button @click="processImport"
                        class="flex-1 py-2 bg-signal-orange text-charcoal font-bold hover:bg-signal-orange-dark transition-colors text-xs">IMPORT</button>
                    <button @click="importModalOpen = false"
                        class="flex-1 py-2 bg-charcoal-light border border-charcoal-border hover:bg-charcoal-lighter transition-colors text-xs font-bold">CANCEL</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Clear Modal -->
    <div x-show="confirmModalOpen" x-cloak x-transition.opacity class="modal-backdrop">
        <div
            class="bg-charcoal border-2 border-signal-red w-full max-w-[350px] mx-4 flex flex-col items-center p-6 text-center animate-shake">
            <div class="text-signal-red text-4xl mb-4 font-bold">⚠️</div>
            <h3 class="text-lg font-bold text-signal-red mb-2">ERASE ALL DATA?</h3>
            <p class="text-xs text-text-muted mb-6 px-4">This action cannot be undone. All stats and history will be
                reset.</p>
            <div class="flex gap-3 w-full">
                <button @click="performClear"
                    class="flex-1 py-3 bg-signal-red text-charcoal font-bold hover:bg-signal-red-dark transition-colors">YES,
                    ERASE</button>
                <button @click="confirmModalOpen = false"
                    class="flex-1 py-3 border border-charcoal-border text-text-primary hover:bg-charcoal-light transition-colors">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- ═══════════════════════════════════════════════════════════════════════════════
         ROUND SUMMARY MODAL
         ═══════════════════════════════════════════════════════════════════════════════ -->
    <div x-show="round.isComplete" x-cloak x-transition.opacity @keydown.escape.window="closeRoundSummary()"
        class="modal-backdrop">
        <div class="bg-charcoal border-2 border-terminal-green w-full max-w-md mx-4 shadow-[0_0_40px_rgba(0,210,106,0.2)]"
            @click.outside="closeRoundSummary()">
            <!-- Header -->
            <div class="p-6 text-center border-b border-charcoal-border">
                <div class="text-terminal-green text-3xl font-bold tracking-wide mb-1">ROUND COMPLETE</div>
                <div class="text-text-muted text-sm"
                    x-text="round.targetCount + ' QUESTIONS · ' + practice.category.toUpperCase()"></div>
            </div>

            <!-- Stats Grid -->
            <div class="p-4">
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="stat-box">
                        <div class="text-xs text-text-muted mb-1">ACCURACY</div>
                        <div class="text-2xl font-bold text-terminal-green" x-text="roundAccuracy + '%'"></div>
                    </div>
                    <div class="stat-box">
                        <div class="text-xs text-text-muted mb-1">AVG TIME</div>
                        <div class="text-2xl font-bold text-text-primary" x-text="roundAvgTime"></div>
                    </div>
                </div>
                <div class="grid grid-cols-3 gap-2">
                    <div class="stat-box">
                        <div class="text-xs text-text-muted">FAST</div>
                        <div class="text-xl font-bold text-terminal-green" x-text="round.stats.fast"></div>
                    </div>
                    <div class="stat-box">
                        <div class="text-xs text-text-muted">SLOW</div>
                        <div class="text-xl font-bold text-signal-orange" x-text="round.stats.slow"></div>
                    </div>
                    <div class="stat-box">
                        <div class="text-xs text-text-muted">ERRORS</div>
                        <div class="text-xl font-bold text-signal-red" x-text="round.stats.errors"></div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="p-4 pt-0 flex gap-3">
                <button @click="startNewRound()"
                    class="flex-1 py-3 bg-terminal-green text-charcoal font-bold hover:bg-terminal-green-dim transition-colors">
                    NEW ROUND
                </button>
                <button @click="closeRoundSummary()"
                    class="flex-1 py-3 border border-charcoal-border text-text-muted hover:text-text-primary hover:border-text-muted transition-colors">
                    CLOSE
                </button>
            </div>
        </div>
    </div>
</body>

</html>